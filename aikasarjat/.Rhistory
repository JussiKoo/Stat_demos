data <- read.csv2("empl.csv", header=T)
osuus <- data$unempl/data$population
#a
ue <- ts(osuus, start=1993, frequency=12)
plot(ue)
#b
ma_smooth <- function(x, window_size) {
win <- rep(1/window_size, window_size) # painot
stats::filter(x, win, sides=2)
}
ue_smooth <- ma_smooth(ue, 12)
ts.plot(ue, ue_smooth, gpars=list(xlab="vuosi", ylab="työttömien osuus",
col=c("blue","red")))
ue_r <- ue - ue_smooth
ts.plot(ue_r)
ts.plot(ue_r, gpars=list(xlab="vuosi", ylab="jäännös"))
acf(ue_r, na.action=omit)
acf(ue_r, na.action=na.omit)
ts.plot(ue, ue_smooth, gpars=list(xlab="vuosi", ylab="työttömien osuus",
col=c("blue","red")))
ue_r <- ue - ue_smooth
ts.plot(ue_r, gpars=list(xlab="vuosi", ylab="jäännös"))
acf(ue_r, na.action=na.omit)
?acf
length(ue_r)
acf(ue_r, lag_max=20, na.action=na.omit)
acf(ue_r, lag.max=20, na.action=na.omit)
acf(ue_r, na.action=na.omit)
ts.plot(ue, ue_smooth, gpars=list(xlab="vuosi", ylab="työttömien osuus",
col=c("blue","red")))
acf(ue_r, na.action=na.omit)
m <- month.abb[cycle(ue)]
m
?month.abb
?cycle
ue
cycle(ue)
m <- month.abb[cycle(ue)]
m
model <- lm(ue_r ~ m)
model
fitted(model)
plot(fitted(model))
plot(fitted(model), type="l")
plot(resid(model))
plot(fitted(model), type="l")
plot(ue)
ts.plot(ue_r, gpars=list(xlab="vuosi", ylab="jäännös"))
ts.plot(fitted(model), ue_r, gpars=list(xlab="vuosi", ylab="työttömien osuus",
col=c("blue","red")))
length(fitted(model))
length(ue_r)
plot(ue_r)
?plot
plot(ue_r, type="p")
plot(ue_r, type="p", c="red")
plot(ue_r, type="p", col="red")
lines(fitted(model))
plot(ue_r, type="p", col="red")
lines(fitted(model))
?lines
plot(fitted(model))
plot(fitted(model), type="l")
plot(ue_r, type="p", col="red")
plot(fitted(model), type="l")
plot(ue_r, type="p", col="red")
plot(fitted(model), type="l")
lines(fitted(model), type="l")
plot(ue_r, type="p", col="red")
lines(fitted(model), type="l")
plot(1:length(ue_r), ue_r, type="p", col="red")
lines(1:length(ue_r), fitted(model), type="l")
lines(1:length(fitted(model)), fitted(model), type="l")
plot(resid(model))
ue.d <- decompose(ue)
plot(ue.d)
plot(1:length(ue_r), ue_r, type="p", col="red")
lines(1:length(fitted(model)), fitted(model), type="l")
plot(ue.d)
plot(1:length(ue_r), ue_r, type="p", col="red")
lines(1:length(fitted(model)), fitted(model), type="l")
ue.d <- decompose(ue)
plot(ue.d)
ue.stl <- stl(ue, "per")
plot(ue.stl)
ue.d <- decompose(ue)
plot(ue.d)
ue.stl <- stl(ue, "per")
plot(ue.stl)
ue.d <- decompose(ue)
plot(ue.d)
ue.stl <- stl(ue, "per")
plot(ue.stl)
?stl
